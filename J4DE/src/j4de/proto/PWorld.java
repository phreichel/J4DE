//*************************************************************************************************
package j4de.proto;
//*************************************************************************************************

//*************************************************************************************************
import java.util.List;
import java.util.ArrayList;
//*************************************************************************************************

//*************************************************************************************************
import java.io.File;
import java.io.Serializable;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
//*************************************************************************************************

//*************************************************************************************************
public class PWorld implements Serializable {

	//==============================================================================================
	private static final long serialVersionUID = 1L;
	//==============================================================================================

	//==============================================================================================
	private static final File DATFILE = new File("data/WORLD.DAT");
	//==============================================================================================

	//==============================================================================================
	private List<PEntity> entities = null;
	//==============================================================================================
	
	//==============================================================================================
	public PWorld() {
		super();
		this.entities = new ArrayList<PEntity>();
	}
	//==============================================================================================

	//==============================================================================================
	public void init() {
		if (DATFILE.exists()) {
			this.load(DATFILE);			
		}
	}
	//==============================================================================================

	//==============================================================================================
	public void step() {
		
	}
	//==============================================================================================

	//==============================================================================================
	public void done() {
		this.store(DATFILE);			
	}
	//==============================================================================================

	//==============================================================================================
	@SuppressWarnings("unchecked")
	private void load(File file) {
		try {
			FileInputStream   ifs = new FileInputStream(DATFILE);
			ObjectInputStream ids = new ObjectInputStream(ifs);
			entities = (List<PEntity>) ids.readObject();
			ids.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	//==============================================================================================

	//==============================================================================================
	private void store(File file) {
		try {
			FileOutputStream   ofs = new FileOutputStream(DATFILE);
			ObjectOutputStream ods = new ObjectOutputStream(ofs);
			ods.writeObject(entities);
			ods.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	//==============================================================================================
	
}
//*************************************************************************************************
