/***************************************************************************************************
 * File:    Capsule.java
 * Project: J4DE
 * 
 * @author  Philip
 * @date    10.07.2018
 **************************************************************************************************/

//*************************************************************************************************
package j4de.geometry;
//*************************************************************************************************

//*************************************************************************************************
import j4de.math.D3Vector;
//*************************************************************************************************

//*************************************************************************************************
public class Capsule {

	//==============================================================================================
	private D3Vector pointA  = null;
	private Double   radiusA = null;
	private D3Vector pointB  = null;
	private Double   radiusB = null;
	//==============================================================================================

	//==============================================================================================
	public D3Vector getPointA() {
		return this.pointA;
	}
	//==============================================================================================
	
	//==============================================================================================
	public void setPointA(D3Vector pointA) {
		this.pointA = pointA;
	}
	//==============================================================================================

	//==============================================================================================
	public Double getRadiusA() {
		return this.radiusA;
	}
	//==============================================================================================
	
	//==============================================================================================
	public void setRadiusA(Double radiusA) {
		this.radiusA = radiusA;
	}
	//==============================================================================================
	
	//==============================================================================================
	public D3Vector getPointB() {
		return this.pointB;
	}
	//==============================================================================================
	
	//==============================================================================================
	public void setPointB(D3Vector pointB) {
		this.pointB = pointB;
	}
	//==============================================================================================

	//==============================================================================================
	public Double getRadiusB() {
		return this.radiusB;
	}
	//==============================================================================================
	
	//==============================================================================================
	public void setRadiusB(Double radiusB) {
		this.radiusB = radiusB;
	}
	//==============================================================================================

	//==============================================================================================
	public Double getFullLength() {
		return
			this.getRadiusA() +
			this.getShaftLength() +
			this.getRadiusB();
	}
	//==============================================================================================
	
	//==============================================================================================
	public Double getShaftLength() {
		D3Vector tmp = new D3Vector();
		tmp.sub(this.getPointB(), this.getPointA());
		return tmp.length();
	}
	//==============================================================================================

	//==============================================================================================
	public Double getShaftRadius(Double alpha) {
		return
				this.getRadiusA() * (1.0 + alpha) +
				this.getRadiusB() * (0.0 + alpha);
	}
	//==============================================================================================

	//==============================================================================================
	public boolean withinSphereA(D3Vector v) {
		D3Vector tmp = new D3Vector();
		tmp.sub(v, this.getPointA());
		return tmp.length() <= this.getRadiusA(); 
	}
	//==============================================================================================

	//==============================================================================================
	public boolean withinSphereB(D3Vector v) {
		D3Vector tmp = new D3Vector();
		tmp.sub(v, this.getPointB());
		return tmp.length() <= this.getRadiusB(); 
	}
	//==============================================================================================

	//==============================================================================================
	public boolean withinShaft(D3Vector v) {
		D3Vector tmpAV = new D3Vector();
		D3Vector tmpAB = new D3Vector();
		D3Vector tmpC  = new D3Vector();
		D3Vector tmpCV = new D3Vector();
		tmpAV.sub(v, this.getPointA());
		tmpAB.sub(this.getPointB(), this.getPointA());
		Double dot = tmpAV.dot(tmpAB);
		if (dot < 0.0) return false;
		if (dot > tmpAB.length()) return false;
		Double alpha = dot / tmpAB.length();
		tmpC.addScaled(this.getPointA(), tmpAB, alpha);
		tmpCV.sub(v, tmpC);
		double radius = this.getShaftRadius(alpha);
		return tmpCV.length() <= radius;
	}
	//==============================================================================================
	
}
//*************************************************************************************************
